[gd_scene load_steps=48 format=3 uid="uid://cjye6xpdv34of"]

[ext_resource type="Script" path="res://PlayerCharacter/Scripts/PlayerCharacter.gd" id="1_0akyq"]
[ext_resource type="Script" path="res://PlayerCharacter/Scripts/PCMovement.gd" id="1_7j0ss"]
[ext_resource type="Script" path="res://PlayerCharacter/Scripts/PlayerRotator.gd" id="2_0m5xn"]
[ext_resource type="PackedScene" uid="uid://cek5x81rd0yiw" path="res://UI/ui.tscn" id="2_d3p1y"]
[ext_resource type="AudioStream" uid="uid://cutr6jwmfjvqx" path="res://PlayerCharacter/Sounds/Movement/Normal/Tanuki Step 01.wav" id="2_vw0dl"]
[ext_resource type="Script" path="res://PlayerCharacter/Scripts/TransformationChange.gd" id="3_bjmh7"]
[ext_resource type="AudioStream" uid="uid://rp3ugwufrtnw" path="res://PlayerCharacter/Sounds/Movement/Normal/Tanuki Step 02.wav" id="3_yyw17"]
[ext_resource type="AudioStream" uid="uid://dvfsa3rk5d6nt" path="res://PlayerCharacter/Sounds/Movement/Normal/Tanuki Step 03.wav" id="4_ssnr2"]
[ext_resource type="AudioStream" uid="uid://f4uw1q51on1" path="res://PlayerCharacter/Sounds/Movement/Normal/Tanuki Step 04.wav" id="5_mbc8e"]
[ext_resource type="AudioStream" uid="uid://c0fyrvpn5gydq" path="res://PlayerCharacter/Sounds/Movement/Normal/Tanuki Step 05.wav" id="6_87xno"]
[ext_resource type="PackedScene" uid="uid://bqguar4cro7y5" path="res://PlayerCharacter/tail.tscn" id="6_gubbw"]
[ext_resource type="AudioStream" uid="uid://pub41g32v4s1" path="res://PlayerCharacter/Sounds/Object selected and saved 2.wav" id="7_r4d5s"]
[ext_resource type="AudioStream" uid="uid://dve851xu5rack" path="res://PlayerCharacter/Sounds/Transformation (Tanuki to Object).wav" id="7_yl2lp"]
[ext_resource type="AudioStream" uid="uid://cgjofq6okjvbk" path="res://PlayerCharacter/Sounds/Movement While Transformed.wav" id="8_bh82x"]
[ext_resource type="AudioStream" uid="uid://df2w543pitow6" path="res://PlayerCharacter/Sounds/Transformation time low.wav" id="8_bhedw"]
[ext_resource type="AudioStream" uid="uid://bv55d6egj6hss" path="res://PlayerCharacter/Sounds/Transformation (Object to Tanuki).wav" id="8_rlmsq"]
[ext_resource type="AudioStream" uid="uid://cioi8ccilonij" path="res://PlayerCharacter/Sounds/Tail appears while transformed.wav" id="9_3jagt"]
[ext_resource type="PackedScene" uid="uid://tp0v8dsqkf32" path="res://PlayerCharacter/player_attack.tscn" id="13_dunae"]
[ext_resource type="Texture2D" uid="uid://c81psw8hrc3xj" path="res://PlayerCharacter/Sprites/Tan-2.0.1-200.png" id="14_6hj2i"]
[ext_resource type="AudioStream" uid="uid://bhkwjvhngjtj6" path="res://PlayerCharacter/Sounds/Tanuki_Main Attack.wav" id="15_fe3wv"]
[ext_resource type="Script" path="res://PlayerCharacter/PlayerMovementSounds.gd" id="16_qikhy"]

[sub_resource type="AtlasTexture" id="AtlasTexture_wn81u"]
atlas = ExtResource("14_6hj2i")
region = Rect2(0, 0, 29, 12)

[sub_resource type="AtlasTexture" id="AtlasTexture_3in7f"]
atlas = ExtResource("14_6hj2i")
region = Rect2(0, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_bcb7t"]
atlas = ExtResource("14_6hj2i")
region = Rect2(128, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_xcfwd"]
atlas = ExtResource("14_6hj2i")
region = Rect2(256, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_p3xcx"]
atlas = ExtResource("14_6hj2i")
region = Rect2(384, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_6558d"]
atlas = ExtResource("14_6hj2i")
region = Rect2(512, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_efoux"]
atlas = ExtResource("14_6hj2i")
region = Rect2(640, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_qwam2"]
atlas = ExtResource("14_6hj2i")
region = Rect2(768, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_bc8ov"]
atlas = ExtResource("14_6hj2i")
region = Rect2(896, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_sjklo"]
atlas = ExtResource("14_6hj2i")
region = Rect2(1024, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_8wv20"]
atlas = ExtResource("14_6hj2i")
region = Rect2(1152, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_146nu"]
atlas = ExtResource("14_6hj2i")
region = Rect2(1280, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_arwah"]
atlas = ExtResource("14_6hj2i")
region = Rect2(1408, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_o3nxa"]
atlas = ExtResource("14_6hj2i")
region = Rect2(1536, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_yggeg"]
atlas = ExtResource("14_6hj2i")
region = Rect2(1664, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_mbedw"]
atlas = ExtResource("14_6hj2i")
region = Rect2(1792, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_wr24i"]
atlas = ExtResource("14_6hj2i")
region = Rect2(1920, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_pvser"]
atlas = ExtResource("14_6hj2i")
region = Rect2(2048, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_fe6ea"]
atlas = ExtResource("14_6hj2i")
region = Rect2(2176, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_oa1tn"]
atlas = ExtResource("14_6hj2i")
region = Rect2(2304, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_c4a1b"]
atlas = ExtResource("14_6hj2i")
region = Rect2(2432, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_tqb71"]
atlas = ExtResource("14_6hj2i")
region = Rect2(2560, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_2gn48"]
atlas = ExtResource("14_6hj2i")
region = Rect2(2688, 0, 128, 128)

[sub_resource type="AtlasTexture" id="AtlasTexture_5loro"]
atlas = ExtResource("14_6hj2i")
region = Rect2(2816, 0, 128, 128)

[sub_resource type="SpriteFrames" id="SpriteFrames_5la1i"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_wn81u")
}],
"loop": true,
"name": &"hidden",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_3in7f")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_bcb7t")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_xcfwd")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_p3xcx")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_6558d")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_efoux")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_qwam2")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_bc8ov")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_sjklo")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_8wv20")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_146nu")
}],
"loop": true,
"name": &"idle",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_arwah")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_o3nxa")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_yggeg")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_mbedw")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_wr24i")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_pvser")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_fe6ea")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_oa1tn")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_c4a1b")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_tqb71")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_2gn48")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_5loro")
}],
"loop": true,
"name": &"running",
"speed": 10.0
}]

[sub_resource type="CircleShape2D" id="CircleShape2D_nxjry"]
radius = 40.0

[node name="PlayerCharacter" type="CharacterBody2D" node_paths=PackedStringArray("tailRef", "transformationChangeRef", "movementRef", "spriteRef", "playerHUD", "playerMovement", "playerRotator")]
collision_layer = 11
script = ExtResource("1_0akyq")
tailRef = NodePath("Rotator/TransformationChange/Tail")
transformationChangeRef = NodePath("Rotator/TransformationChange")
movementRef = NodePath("Rotator/PlayerMovement")
spriteRef = NodePath("AnimatedSprite2D")
playerHUD = NodePath("CanvasLayer/HBoxContainer/UI")
playerMovement = NodePath("Rotator/PlayerMovement")
playerRotator = NodePath("Rotator")

[node name="Sounds" type="Node" parent="."]

[node name="Movement" type="Node" parent="Sounds"]

[node name="Normal" type="Node" parent="Sounds/Movement"]

[node name="CurrentStep" type="AudioStreamPlayer" parent="Sounds/Movement/Normal"]

[node name="Step1" type="AudioStreamPlayer" parent="Sounds/Movement/Normal"]
stream = ExtResource("2_vw0dl")

[node name="Step2" type="AudioStreamPlayer" parent="Sounds/Movement/Normal"]
stream = ExtResource("3_yyw17")

[node name="Step3" type="AudioStreamPlayer" parent="Sounds/Movement/Normal"]
stream = ExtResource("4_ssnr2")

[node name="Step4" type="AudioStreamPlayer" parent="Sounds/Movement/Normal"]
stream = ExtResource("5_mbc8e")

[node name="Step5" type="AudioStreamPlayer" parent="Sounds/Movement/Normal"]
stream = ExtResource("6_87xno")

[node name="EnterTransformation" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource("7_yl2lp")

[node name="ExitTransformation" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource("8_rlmsq")

[node name="TransformedMovement" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource("8_bh82x")

[node name="Attack" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource("15_fe3wv")

[node name="ObjectSaved" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource("7_r4d5s")

[node name="TransformationTimeLow" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource("8_bhedw")

[node name="TailAppears" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource("9_3jagt")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
sprite_frames = SubResource("SpriteFrames_5la1i")
animation = &"idle"

[node name="Camera2D" type="Camera2D" parent="."]
zoom = Vector2(0.75, 0.75)

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="HBoxContainer" type="HBoxContainer" parent="CanvasLayer"]
offset_right = 40.0
offset_bottom = 40.0

[node name="UI" parent="CanvasLayer/HBoxContainer" instance=ExtResource("2_d3p1y")]
z_index = 1
z_as_relative = false
layout_mode = 2

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("CircleShape2D_nxjry")

[node name="Rotator" type="Node2D" parent="."]
script = ExtResource("2_0m5xn")
downRad = 180
leftRad = 270
rightRad = 90

[node name="Sprite2D" type="Sprite2D" parent="Rotator"]

[node name="TransformationChange" type="Node2D" parent="Rotator" node_paths=PackedStringArray("tailRef", "tailLocation", "playerRef", "baseCollisionShape", "playerSprite", "enterTransformationSound", "exitTransformationSound", "playerTransformedSprite", "objectSavedSound", "transformationTimeLowSound", "tailAppearsSound")]
script = ExtResource("3_bjmh7")
transformationDuration = 20.0
tailActivationTime = 7.0
lowTimeRemaining = 17.0
timeRefundOnReactivation = 1.0
tailRef = NodePath("Tail")
tailLocation = NodePath("TailLocation")
playerRef = NodePath("../..")
baseCollisionShape = NodePath("../../CollisionShape2D")
playerSprite = NodePath("../../AnimatedSprite2D")
enterTransformationSound = NodePath("../../Sounds/EnterTransformation")
exitTransformationSound = NodePath("../../Sounds/ExitTransformation")
playerTransformedSprite = NodePath("../Sprite2D")
objectSavedSound = NodePath("../../Sounds/ObjectSaved")
transformationTimeLowSound = NodePath("../../Sounds/TransformationTimeLow")
tailAppearsSound = NodePath("../../Sounds/TailAppears")
transformationLockDuration = 0.3

[node name="TailLocation" type="Node2D" parent="Rotator/TransformationChange"]
position = Vector2(0, 75)

[node name="Tail" parent="Rotator/TransformationChange" instance=ExtResource("6_gubbw")]

[node name="PlayerMovement" type="Node2D" parent="Rotator" node_paths=PackedStringArray("rigidbodyRef", "playerRef")]
script = ExtResource("1_7j0ss")
rigidbodyRef = NodePath("../..")
accelerationPerSecond = 700.0
defaultMaxSpeed = 500.0
playerRef = NodePath("../..")

[node name="PlayerMovementSounds" type="Node2D" parent="Rotator" node_paths=PackedStringArray("playerMovement", "playerRef", "currentNormalStep", "normalMovementSounds", "transformedMovementSound")]
script = ExtResource("16_qikhy")
playerMovement = NodePath("../PlayerMovement")
playerRef = NodePath("../..")
currentNormalStep = NodePath("../../Sounds/Movement/Normal/CurrentStep")
normalMovementSounds = [NodePath("../../Sounds/Movement/Normal/Step1"), NodePath("../../Sounds/Movement/Normal/Step2"), NodePath("../../Sounds/Movement/Normal/Step3"), NodePath("../../Sounds/Movement/Normal/Step4"), NodePath("../../Sounds/Movement/Normal/Step5")]
transformedMovementSound = NodePath("../../Sounds/TransformedMovement")

[node name="PlayerAttack" parent="Rotator" node_paths=PackedStringArray("playerHUD", "attackHitboxes", "attackSounds", "characterRef") instance=ExtResource("13_dunae")]
playerHUD = NodePath("../../CanvasLayer/HBoxContainer/UI")
attackHitboxes = [null, NodePath("PlayerAttackHitbox"), null]
attackSounds = [null, NodePath("../../Sounds/Attack"), null]
characterRef = NodePath("../..")

[connection signal="change_speed" from="Rotator/TransformationChange" to="Rotator/PlayerMovement" method="_on_transformation_change_change_speed"]
[connection signal="reset_speed" from="Rotator/TransformationChange" to="Rotator/PlayerMovement" method="_on_transformation_change_reset_speed"]
[connection signal="send_transformation_active_info" from="Rotator/TransformationChange" to="CanvasLayer/HBoxContainer/UI" method="_on_transformation_change_send_transformation_active_info"]
[connection signal="send_transformation_name" from="Rotator/TransformationChange" to="CanvasLayer/HBoxContainer/UI" method="_on_transformation_change_send_transformation_name"]
[connection signal="movement_direction" from="Rotator/PlayerMovement" to="Rotator" method="_on_movement_movement_direction"]
